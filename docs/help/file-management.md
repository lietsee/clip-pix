# ファイルの取り扱い

ClipPixでのファイル管理について説明します。

---

## フォルダ構造

ClipPixは選択したフォルダを以下のように使用します：

```
選択フォルダ/
├── clipboard_2025-12-07T14-30-45-123.png      ← 画像ファイル
├── clipboard_2025-12-07T14-30-45-123.json     ← メタデータ
├── text_2025-12-07T14-35-00-456.txt           ← テキストファイル
├── text_2025-12-07T14-35-00-456.json          ← メタデータ
├── サブフォルダ1/                              ← サブフォルダ
│   ├── image.png
│   └── image.json
├── サブフォルダ2/
│   └── ...
└── .trash/                                     ← ゴミ箱（削除ファイル）
    ├── deleted_image.png
    └── deleted_image.json
```

---

## サブフォルダの使い方

### タブ切り替え

画面上部のタブバーでルートフォルダとサブフォルダを切り替えられます。

- **ルート**: 選択フォルダ直下のコンテンツを表示
- **サブフォルダ名**: そのサブフォルダ内のコンテンツを表示

### 新規フォルダ作成

タブバー右端の **＋ボタン** をクリックすると、新規サブフォルダを作成できます。

1. ＋ボタンをクリック
2. フォルダ名を入力
3. OKをクリック
4. 作成されたフォルダに自動的に移動

> フォルダ名に `/` や `\` は使用できません。

---

## ゴミ箱（.trash）

削除したファイルは完全に消去されず、`.trash` フォルダに移動します。

### 削除方法

1. カード右上の**削除ボタン**（ゴミ箱アイコン）をクリック
2. 確認ダイアログで「OK」をクリック
3. ファイルが `.trash` フォルダに移動

### ゴミ箱の確認

タブバーで `.trash` タブを選択すると、削除したファイルを確認できます。

### 完全削除

`.trash` フォルダ内のファイルを削除すると、完全に消去されます。

> ゴミ箱はアプリ内で自動的に空になりません。手動で管理してください。

---

## 一括削除モード

複数のカードを同時に削除できます。

### 使い方

1. ツールバーの**削除モードボタン**（ゴミ箱アイコン）をクリック
2. 各カードにチェックボックスが表示される
3. 削除したいカードをクリックして選択
4. ツールバーの**削除ボタン**をクリック
5. 確認ダイアログで「OK」をクリック
6. 選択したファイルがまとめてゴミ箱に移動

### キャンセル

削除モード中に**キャンセルボタン**をクリックすると、選択を解除して通常モードに戻ります。

---

## メタデータJSON

各ファイルには対応するJSONメタデータファイルが自動生成されます。

### ファイル名

元のファイル名に `.json` を追加したものです。

- `clipboard_2025-12-07T14-30-45-123.png` → `clipboard_2025-12-07T14-30-45-123.json`

### 内容

```json
{
  "id": "unique-identifier",
  "sourceType": "clipboard",
  "width": 1920,
  "height": 1080,
  "size": 524288,
  "createdAt": "2025-12-07T14:30:45.123Z",
  "memo": "メモ内容",
  "favorite": 2,
  "scale": 1.5,
  "offset": {"dx": 10, "dy": -5}
}
```

| フィールド | 説明 |
|-----------|------|
| `id` | ファイルの一意識別子 |
| `sourceType` | 保存元（`clipboard`, `web`, `local`） |
| `width` / `height` | 画像サイズ（画像の場合） |
| `size` | ファイルサイズ（バイト） |
| `createdAt` | 保存日時 |
| `memo` | ユーザーが追加したメモ |
| `favorite` | お気に入りレベル（0-3） |
| `scale` | 表示スケール |
| `offset` | パンオフセット |

### 注意事項

- メタデータファイルを直接編集することは推奨しません
- メタデータファイルを削除すると、お気に入りやメモがリセットされます
- 画像ファイルだけ移動すると、メタデータとの紐付けが切れます

---

## 手動でファイルを追加する

ClipPixの監視フォルダにファイルを直接追加することもできます。

1. エクスプローラー（Finder）で選択フォルダを開く
   - パンくずリスト（画面上部のパス表示）をクリック
2. 画像・テキスト・PDFファイルをフォルダにコピー
3. ClipPixが自動的に検知してグリッドに表示

> 手動追加したファイルにはメタデータが自動生成されます。
