# クリップボード監視

ClipPixの中核機能である「クリップボード監視」について説明します。

---

## 自動保存の仕組み

クリップボード監視をONにすると、システムのクリップボードを常時監視します。画像やテキストがコピーされると、自動的に選択フォルダに保存されます。

```
[コピー操作] → [クリップボード] → [ClipPixが検知] → [ファイル保存] → [グリッドに表示]
```

---

## 対応コンテンツ

### 画像

以下の形式の画像をクリップボードから自動保存できます：

- PNG
- JPEG / JPG
- BMP
- GIF
- WebP
- その他、システムがサポートする画像形式

### テキスト

プレーンテキストをコピーすると、テキストファイル（`.txt`）として保存されます。

- 空白のみのテキストは保存されません
- 改行を含むテキストも保存可能

### URL（画像の自動ダウンロード）

画像のURLをコピーすると、自動的にダウンロードして保存します。

**対応URL例**:
- `https://example.com/image.png`
- `https://example.com/photo.jpg`
- `https://i.imgur.com/xxxxx.png`

**対応拡張子**: `.png`, `.jpg`, `.jpeg`, `.gif`, `.webp`, `.bmp`

> URLがテキストとして保存されるのではなく、実際の画像ファイルがダウンロードされます。

---

## ファイル命名規則

自動保存されるファイルは以下の命名規則に従います：

| 種類 | ファイル名パターン | 例 |
|------|-------------------|-----|
| **画像** | `clipboard_YYYY-MM-DDTHH-mm-ss-SSS.png` | `clipboard_2025-12-07T14-30-45-123.png` |
| **テキスト** | `text_YYYY-MM-DDTHH-mm-ss-SSS.txt` | `text_2025-12-07T14-30-45-123.txt` |
| **URL画像** | `url_YYYY-MM-DDTHH-mm-ss-SSS_[domain].png` | `url_2025-12-07T14-30-45-123_imgur.png` |

---

## 重複検出

同じ内容を連続してコピーした場合、重複保存を防ぐ仕組みがあります。

- **2秒以内**に同一内容がコピーされた場合はスキップ
- **アプリからのコピー**（画像カードのCtrl+Cなど）は自動的に無視

---

## 監視のON/OFF

### ONにする方法

1. ツールバーのクリップボードスイッチをクリック
2. スイッチが緑色になれば監視中

### OFFにする方法

1. ツールバーのクリップボードスイッチをクリック
2. スイッチが灰色になれば停止中

> 監視OFFの間にコピーした内容は保存されません。

---

## プラットフォーム別の動作

### Windows

- **Hookモード**: Windows Native Hookによる即座の検知（推奨）
- **ポーリングモード**: 500ms間隔でクリップボード確認（フォールバック）

Hookモードが利用できない場合、自動的にポーリングモードに切り替わります。

### macOS

- **ポーリングモード**: 500ms間隔でクリップボード確認
- **macOS 15.4以降**: クリップボードアクセスの許可が必要になる場合があります

---

## トラブルシューティング

### 画像が保存されない

1. クリップボード監視がONになっているか確認
2. フォルダが正しく選択されているか確認
3. フォルダへの書き込み権限があるか確認

### テキストが保存されない

1. 空白のみのテキストは保存されません
2. 非常に長いテキストは保存に時間がかかる場合があります

### URLから画像がダウンロードされない

1. URLが画像の直接リンクか確認（ページURLではなく画像URL）
2. インターネット接続を確認
3. 一部のサイトはダウンロードをブロックしている場合があります
